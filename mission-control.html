<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gunnar Mission Control</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        :root {
            color-scheme: light dark;
            --bg: #050816;
            --panel: rgba(15, 23, 42, 0.85);
            --panel-border: rgba(148, 163, 184, 0.2);
            --text: #e2e8f0;
            --muted: #94a3b8;
            --accent: #67e8f9;
            --accent-2: #a855f7;
        }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: radial-gradient(circle at top, rgba(103, 232, 249, 0.15), transparent 45%),
                        radial-gradient(circle at 30% 20%, rgba(168, 85, 247, 0.15), transparent 40%),
                        var(--bg);
            min-height: 100vh;
            color: var(--text);
            padding: clamp(1.5rem, 3vw, 3rem);
        }
        header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: flex-end;
        }
        h1 {
            font-size: clamp(2rem, 4vw, 3rem);
            letter-spacing: -0.02em;
            margin: 0;
        }
        .subtitle {
            color: var(--muted);
            margin-top: 0.35rem;
        }
        .nav-links a {
            text-decoration: none;
            color: var(--text);
            border: 1px solid var(--panel-border);
            border-radius: 999px;
            padding: 0.5rem 1.25rem;
            font-size: 0.9rem;
            transition: border 0.2s ease, transform 0.2s ease;
        }
        .nav-links a + a { margin-left: 0.75rem; }
        .nav-links a:hover { border-color: var(--accent); transform: translateY(-2px); }
        .grid {
            display: grid;
            gap: clamp(1rem, 2vw, 1.5rem);
        }
        .grid.stats {
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            margin-bottom: 2rem;
        }
        .card {
            position: relative;
            background: var(--panel);
            border: 1px solid var(--panel-border);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 25px 50px rgba(2, 6, 23, 0.65);
            overflow: hidden;
        }
        .card::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 20px;
            padding: 1px;
            background: linear-gradient(135deg, rgba(103, 232, 249, 0.35), rgba(168, 85, 247, 0.35));
            -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
        }
        .card h3 {
            margin: 0;
            font-size: 0.9rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: var(--muted);
        }
        .stat-value {
            font-size: 2.25rem;
            font-weight: 600;
            margin-top: 0.35rem;
        }
        .stat-subtext {
            color: var(--muted);
            margin-top: 0.35rem;
            font-size: 0.9rem;
        }
        h2.section-title {
            font-size: 1.25rem;
            margin: 0 0 1rem 0;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--muted);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            color: var(--text);
            font-size: 0.95rem;
        }
        th, td {
            padding: 0.85rem 0.5rem;
        }
        th {
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 0.15em;
            color: var(--muted);
            border-bottom: 1px solid var(--panel-border);
        }
        tr + tr td {
            border-top: 1px solid rgba(148, 163, 184, 0.1);
        }
        .badge {
            display: inline-flex;
            align-items: center;
            border-radius: 999px;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            font-weight: 600;
        }
        .badge-active { background: rgba(34, 197, 94, 0.15); color: #4ade80; }
        .badge-alert { background: rgba(248, 113, 113, 0.15); color: #f87171; }
        .badge-pending { background: rgba(251, 191, 36, 0.15); color: #facc15; }
        .timeline {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .timeline-entry {
            display: flex;
            gap: 0.85rem;
        }
        .timeline-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--accent);
            margin-top: 0.3rem;
            box-shadow: 0 0 15px var(--accent);
        }
        .timeline-body {
            flex: 1;
        }
        .timeline-body h4 {
            margin: 0;
            font-size: 1rem;
        }
        .timeline-meta {
            font-size: 0.85rem;
            color: var(--muted);
        }
        .system-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1rem;
        }
        .system-card h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
        }
        ul.chip-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
        }
        ul.chip-list li {
            background: rgba(148, 163, 184, 0.12);
            border-radius: 999px;
            padding: 0.25rem 0.75rem;
            font-size: 0.8rem;
        }
        .kanban-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
        }
        .kanban-column {
            background: rgba(148, 163, 184, 0.08);
            border: 1px solid var(--panel-border);
            border-radius: 16px;
            padding: 1rem;
            min-height: 200px;
        }
        .kanban-column h3 {
            margin: 0 0 0.75rem 0;
            font-size: 0.95rem;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }
        .kanban-card {
            background: rgba(15, 23, 42, 0.6);
            border-radius: 12px;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            border: 1px solid rgba(148, 163, 184, 0.15);
            font-size: 0.9rem;
        }
        .kanban-card small {
            display: block;
            color: var(--muted);
            margin-top: 0.35rem;
        }
        .gantt {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .gantt-row {
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
        }
        .gantt-label {
            font-size: 0.85rem;
            color: var(--muted);
            display: flex;
            justify-content: space-between;
        }
        .gantt-bar-shell {
            background: rgba(148, 163, 184, 0.15);
            border-radius: 999px;
            height: 10px;
            overflow: hidden;
        }
        .gantt-bar {
            height: 100%;
            border-radius: 999px;
            background: linear-gradient(90deg, #67e8f9, #a855f7);
        }
        .gauge-wrap {
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }
        .gauge {
            --gauge-value: 0.6;
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: conic-gradient(#67e8f9 calc(var(--gauge-value) * 360deg), rgba(148, 163, 184, 0.2) 0);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 25px rgba(2,6,23,0.6);
        }
        .gauge::after {
            content: "";
            position: absolute;
            width: 65%;
            height: 65%;
            border-radius: 50%;
            background: var(--bg);
        }
        .gauge-number {
            position: relative;
            font-size: 2rem;
            font-weight: 600;
        }
        .gauge-meta {
            flex: 1;
            min-width: 250px;
        }
        .gauge-meta ul {
            margin: 0.5rem 0 0 1.25rem;
            color: var(--muted);
            line-height: 1.5;
        }
        @media (max-width: 768px) {
            header { flex-direction: column; align-items: flex-start; }
            .nav-links { width: 100%; }
            .nav-links a { display: inline-flex; margin-bottom: 0.5rem; }
        }
    </style>
</head>
<body>
    <header>
        <div>
            <h1>Mission Control</h1>
            <p class="subtitle">Live status of Gunnar automations, detection cadence, and routing</p>
        </div>
        <div class="nav-links">
            <a href="index.html">← Revenue Dashboard</a>
            <a href="automation.html">Automation Feed →</a>
        </div>
    </header>

    <section class="grid stats">
        <article class="card">
            <h3>Active Monitors</h3>
            <p class="stat-value">4</p>
            <p class="stat-subtext">RFP, CCUS permits, Federal grants, Cron heartbeat</p>
        </article>
        <article class="card">
            <h3>Detection Window</h3>
            <p class="stat-value">24h</p>
            <p class="stat-subtext">Newest signals land < 1 day from source publish</p>
        </article>
        <article class="card">
            <h3>Alerts (72h)</h3>
            <p class="stat-value">9</p>
            <p class="stat-subtext">3 routed to pipeline, 6 to knowledge queue</p>
        </article>
        <article class="card">
            <h3>Next Cron Run</h3>
            <p class="stat-value">08:00 PT</p>
            <p class="stat-subtext">Grant tracker + RFP diff in queue</p>
        </article>
    </section>

    <section class="card">
        <h2 class="section-title">Background Automation Load</h2>
        <div class="gauge-wrap">
            <div class="gauge" id="automationGauge" style="--gauge-value:0.6;">
                <div class="gauge-number" id="gaugeNumber">3 / 5</div>
            </div>
            <div class="gauge-meta">
                <p id="automationSummary" style="margin:0; line-height:1.6; color: var(--muted);">Three automation loops are currently running unattended (RFP Scraper, CCUS Monitor, Cron heartbeat).</p>
                <ul>
                    <li><strong>Running:</strong> <span id="runningText">RFP Scraper · CCUS Monitor · Cron heartbeat</span></li>
                    <li><strong>Manual/Queued:</strong> <span id="manualText">Federal grant tracker (429 guard)</span></li>
                    <li><strong>Blocked:</strong> <span id="blockedText">LinkedIn Listener</span></li>
                </ul>
                <small id="automationUpdated" style="color: var(--muted); display:block; margin-top:0.5rem;">Updated just now</small>
            </div>
        </div>
    </section>

    <section class="card">
        <h2 class="section-title">Automation Health</h2>
        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.25rem;">
            <div>
                <table>
                    <thead>
                        <tr>
                            <th>System</th>
                            <th>Status</th>
                            <th>Last Run</th>
                            <th>Output</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>RFP Scraper</td>
                            <td><span class="badge badge-active">OK</span></td>
                            <td>Today · 09:07</td>
                            <td>2 new bids (CalGEM, NM OCD)</td>
                        </tr>
                        <tr>
                            <td>CCUS Permit Monitor</td>
                            <td><span class="badge badge-active">OK</span></td>
                            <td>Feb 15 · 17:02</td>
                            <td>Talos hub → pipeline refresh</td>
                        </tr>
                        <tr>
                            <td>Grant Tracker</td>
                            <td><span class="badge badge-alert">Alert</span></td>
                            <td>Today · 08:04</td>
                            <td>API 429 retry required</td>
                        </tr>
                        <tr>
                            <td>LinkedIn Listener</td>
                            <td><span class="badge badge-pending">Pending</span></td>
                            <td>–</td>
                            <td>Await Sales Navigator token</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div>
                <table>
                    <thead>
                        <tr>
                            <th>System</th>
                            <th>Status</th>
                            <th>Last Run</th>
                            <th>Output</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Target Account Signals</td>
                            <td><span class="badge badge-pending">Building</span></td>
                            <td>–</td>
                            <td>News/API wiring</td>
                        </tr>
                        <tr>
                            <td>Warm Intro Finder</td>
                            <td><span class="badge badge-pending">Blocked</span></td>
                            <td>–</td>
                            <td>LinkedIn scope approval</td>
                        </tr>
                        <tr>
                            <td>Event Monitor</td>
                            <td><span class="badge badge-pending">Backlog</span></td>
                            <td>–</td>
                            <td>Needs calendar ingestion</td>
                        </tr>
                        <tr>
                            <td>Competitor Intelligence</td>
                            <td><span class="badge badge-pending">Backlog</span></td>
                            <td>–</td>
                            <td>NLP + scraping module</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <section class="card">
        <h2 class="section-title">Live Routing Log</h2>
        <div class="timeline">
            <div class="timeline-entry">
                <div class="timeline-dot"></div>
                <div class="timeline-body">
                    <h4>CalGEM urban P&A package detected</h4>
                    <p class="timeline-meta">RFP Scraper · 09:07 PT · Routed to Pipeline → CalGEM</p>
                    <p>Auto-attached Boyle Heights case study brief + reminded Gunnar team to prep pricing grid.</p>
                </div>
            </div>
            <div class="timeline-entry">
                <div class="timeline-dot" style="background:#f87171; box-shadow:0 0 15px #f87171;"></div>
                <div class="timeline-body">
                    <h4>Grants.gov search throttled</h4>
                    <p class="timeline-meta">Grant Tracker · 08:04 PT · Alerted via WhatsApp</p>
                    <p>Queued retry with exponential backoff. Needs API key or request spacing (5/min) adjustment.</p>
                </div>
            </div>
            <div class="timeline-entry">
                <div class="timeline-dot" style="background:#a855f7; box-shadow:0 0 15px #a855f7;"></div>
                <div class="timeline-body">
                    <h4>Talos CCS hub enters comment window</h4>
                    <p class="timeline-meta">CCUS Monitor · Feb 15 · Synced to Opportunity → Talos</p>
                    <p>Triggered reminder to request compliance intro + package relief-ready retainer pricing.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="card">
        <h2 class="section-title">Cron & Alert Matrix</h2>
        <div class="system-grid">
            <div class="system-card">
                <h4>Heartbeat & Cadence</h4>
                <ul class="chip-list">
                    <li>Grant Tracker · daily 08:00</li>
                    <li>RFP Scraper · daily 09:00</li>
                    <li>CCUS Monitor · weekly Fri 17:00</li>
                    <li>Permit diff backup · Sun 06:00</li>
                </ul>
            </div>
            <div class="system-card">
                <h4>Alert Fan-out</h4>
                <ul class="chip-list">
                    <li>WhatsApp → Immediate</li>
                    <li>Dashboard badge → Index + Mission Control</li>
                    <li>memory/YYYY-MM-DD.md → daily digest</li>
                </ul>
            </div>
            <div class="system-card">
                <h4>Pending Actions</h4>
                <ul class="chip-list">
                    <li>Grant API throttle fix</li>
                    <li>LinkedIn auth token</li>
                    <li>Event calendar feed</li>
                    <li>Competitor NLP scaffolding</li>
                </ul>
            </div>
            <div class="system-card">
                <h4>Escalation Rules</h4>
                <ul class="chip-list">
                    <li>2 misses → manual ping</li>
                    <li>Critical bids → auto-create task</li>
                    <li>Data drift → run diagnostics</li>
                </ul>
            </div>
        </div>
    </section>

    <section class="card">
        <h2 class="section-title">Ops Runbook</h2>
        <div class="system-grid">
            <div class="system-card">
                <h4>Model Stack (Current)</h4>
                <p style="color: var(--muted); line-height: 1.6;">Live chat is riding <strong>openai/gpt-5.1-codex</strong> this session, with <strong>anthropic/claude-sonnet-4-5</strong> set as the default brain. The hourly heartbeat already runs on <strong>Claude 3.5 Haiku</strong>, and all browse/fetch work stays on Brave Search + <code>web_fetch</code>. We only swap models when a thread needs it.</p>
                <ul class="chip-list">
                    <li>Brain default: Claude Sonnet 4.5</li>
                    <li>Session override: GPT-5.1 Codex</li>
                    <li>Heartbeat: Claude 3.5 Haiku · 1h</li>
                    <li>Web search: Brave API + web_fetch</li>
                </ul>
                <p style="color: var(--muted); line-height: 1.6;">Quick prompts we actually use: “Switch this convo back to Sonnet”, “Leave heartbeat on Haiku hourly”, “Use the Brave key when you search.”</p>
            </div>
            <div class="system-card">
                <h4>Automation Jobs (Live)</h4>
                <p style="color: var(--muted); line-height: 1.6;">Only the working scrapers are listed here. RFP Scraper runs daily at 09:00 and CCUS Permits every Friday at 17:00. Federal Grant Tracker is wired but still rate-limited (429) so we trigger it by hand until the spacing fix lands.</p>
                <ul class="chip-list">
                    <li><code>cd gunnar-automation && python3 run_automation.py --schedule daily --send-alerts</code></li>
                    <li><code>python3 run_automation.py --schedule weekly --send-alerts</code></li>
                    <li><code>python3 scrapers/grant_tracker.py</code> (manual retry)</li>
                    <li>Logs: <code>tail -f logs/gunnar_automation_*.log</code></li>
                    <li>DB: <code>sqlite3 data/gunnar_automation.db</code></li>
                </ul>
                <p style="color: var(--muted); line-height: 1.6;">If a cron misses twice, run the command above and re-send alerts via <code>alerts/dispatch_alerts.py</code>.</p>
            </div>
            <div class="system-card">
                <h4>Gateway Control & Health</h4>
                <p style="color: var(--muted); line-height: 1.6;">Launchd keeps ai.openclaw.gateway alive on the Mac mini. These are the only commands we use in practice.</p>
                <ul class="chip-list">
                    <li><code>openclaw gateway status</code> / <code>openclaw status --all</code></li>
                    <li><code>openclaw gateway restart</code> (after config)</li>
                    <li><code>launchctl start|stop ai.openclaw.gateway</code></li>
                    <li><code>openclaw channels status --probe</code></li>
                    <li><code>openclaw dashboard --no-open</code> → paste tokenized URL</li>
                </ul>
                <p style="color: var(--muted); line-height: 1.6;">Gateway stays bound to loopback with token auth. Never drop to <code>auth: none</code>.</p>
            </div>
            <div class="system-card">
                <h4>Deployables & Backups</h4>
                <p style="color: var(--muted); line-height: 1.6;">Dashboards ship from <code>dashboards/gunnar</code> (GitHub Pages repo). Automations run locally with SQLite + JSONL history. Current routine:</p>
                <ul class="chip-list">
                    <li><code>cd dashboards/gunnar && git add . && git commit && git push</code></li>
                    <li>Zip <code>gunnar-automation/data</code> to Drive every Friday</li>
                    <li>Track API keys in Apple Keychain</li>
                    <li>Keep workspace restore steps in <code>RESTORE.md</code></li>
                </ul>
                <p style="color: var(--muted); line-height: 1.6;">If something breaks: stop the gateway, copy <code>data/</code>, redeploy from git + Drive backup, then restart.</p>
            </div>
            <div class="system-card">
                <h4>Remote & Emergency</h4>
                <p style="color: var(--muted); line-height: 1.6;">Tailscale already links the Mac mini to the laptop/phone for remote fixes.</p>
                <ul class="chip-list">
                    <li><code>ssh -L 18789:127.0.0.1:18789 user@100.x.x.x</code> (remote dashboard)</li>
                    <li><code>openclaw gateway stop</code> / <code>pkill -f openclaw</code></li>
                    <li><code>openclaw doctor --fix</code>, <code>openclaw security audit --deep</code></li>
                    <li>Rotate Anthropic / Brave / Discord / Telegram tokens if compromised</li>
                </ul>
                <p style="color: var(--muted); line-height: 1.6;">After any incident: revoke API keys, reset bot tokens, review <code>/tmp/openclaw</code> logs, then bring the gateway back up.</p>
            </div>
        </div>
    </section>

    <section class="card">
        <h2 class="section-title">Ops Kanban — Self Development</h2>
        <p style="color: var(--muted); line-height:1.6;">Source of truth lives in <code>ops-kanban.md</code>, mirrored here so you can scan status without leaving the dashboard.</p>
        <div class="kanban-grid">
            <div class="kanban-column">
                <h3>Backlog</h3>
                <div class="kanban-card">Pyenv + pipx realignment<small>Install Python 3.12 via pyenv and point pipx at it.</small></div>
                <div class="kanban-card">Disk-usage watchdog<small>launchd job to ping WhatsApp when root volume >85%.</small></div>
                <div class="kanban-card">Config snapshot & migration doc<small>Snapshot gateway + Tailscale settings for fast rebuilds.</small></div>
                <div class="kanban-card">Grant tracker throttle fix<small>Respect Grants.gov 5 req/min limit or add API key.</small></div>
                <div class="kanban-card">Mission-control JSON feed<small>Expose data for auto-refreshing dashboard cards.</small></div>
            </div>
            <div class="kanban-column">
                <h3>In Progress</h3>
                <div class="kanban-card">Homebrew baseline audit<small>Confirm GNU tool versions + capture <code>brew bundle</code>.</small></div>
                <div class="kanban-card">Automation cron review<small>Verify daily/weekly jobs + add miss-detection pings.</small></div>
                <div class="kanban-card">RESTORE.md expansion<small>Document GitHub/Drive/Tailscale restore flow.</small></div>
            </div>
            <div class="kanban-column">
                <h3>Done</h3>
                <div class="kanban-card">Node 22 + pnpm toolchain</div>
                <div class="kanban-card">Launchd gateway management</div>
                <div class="kanban-card">Haiku heartbeat + Brave search</div>
                <div class="kanban-card">Automation runbook surfacing</div>
            </div>
        </div>
    </section>

    <section class="card">
        <h2 class="section-title">Ops Gantt Snapshot</h2>
        <p style="color: var(--muted); line-height:1.6;">Simple progress view for the active punch list (ETA = target ship date this week).</p>
        <div class="gantt" id="ganttContainer">
            <div class="gantt-row" data-task-id="homebrew">
                <div class="gantt-label"><span class="gantt-name">Homebrew baseline audit</span><span><span class="gantt-eta">ETA: Feb 18</span> • <span class="gantt-progress">40%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:40%;"></div></div>
            </div>
            <div class="gantt-row" data-task-id="cron-review">
                <div class="gantt-label"><span class="gantt-name">Automation cron review</span><span><span class="gantt-eta">ETA: Feb 18</span> • <span class="gantt-progress">30%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:30%;"></div></div>
            </div>
            <div class="gantt-row" data-task-id="restore">
                <div class="gantt-label"><span class="gantt-name">RESTORE.md expansion</span><span><span class="gantt-eta">ETA: Feb 19</span> • <span class="gantt-progress">25%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:25%;"></div></div>
            </div>
            <div class="gantt-row" data-task-id="pyenv">
                <div class="gantt-label"><span class="gantt-name">Pyenv + pipx realignment</span><span><span class="gantt-eta">ETA: Feb 20</span> • <span class="gantt-progress">5%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:5%;"></div></div>
            </div>
            <div class="gantt-row" data-task-id="disk">
                <div class="gantt-label"><span class="gantt-name">Disk-usage watchdog</span><span><span class="gantt-eta">ETA: Feb 21</span> • <span class="gantt-progress">10%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:10%;"></div></div>
            </div>
            <div class="gantt-row" data-task-id="snapshot">
                <div class="gantt-label"><span class="gantt-name">Config snapshot & migration doc</span><span><span class="gantt-eta">ETA: Feb 21</span> • <span class="gantt-progress">15%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:15%;"></div></div>
            </div>
            <div class="gantt-row" data-task-id="grants">
                <div class="gantt-label"><span class="gantt-name">Grant tracker throttle fix</span><span><span class="gantt-eta">ETA: Feb 22</span> • <span class="gantt-progress">2%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:2%;"></div></div>
            </div>
            <div class="gantt-row" data-task-id="json-feed">
                <div class="gantt-label"><span class="gantt-name">Mission-control JSON feed</span><span><span class="gantt-eta">ETA: Feb 23</span> • <span class="gantt-progress">2%</span></span></div>
                <div class="gantt-bar-shell"><div class="gantt-bar" style="width:2%;"></div></div>
            </div>
        </div>
    </section>

    <section class="card">
        <h2 class="section-title">Implementation Notes</h2>
        <div style="display: grid; gap: 1.25rem; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
            <div>
                <h4 style="margin:0 0 0.5rem 0;">Data Sources</h4>
                <p style="color: var(--muted); line-height: 1.6;">CalGEM/NM OCD HTML scrapes → SQLite diff, Grants.gov search2 JSON, EPA Class VI API, manual LinkedIn exports.</p>
            </div>
            <div>
                <h4 style="margin:0 0 0.5rem 0;">Pipelines</h4>
                <p style="color: var(--muted); line-height: 1.6;">Cron jobs orchestrated via OpenClaw. Mission Control renders structured JSON soon (placeholder data for now).</p>
            </div>
            <div>
                <h4 style="margin:0 0 0.5rem 0;">Next Up</h4>
                <p style="color: var(--muted); line-height: 1.6;">Expose mission-control.json, add WebSocket hooks for real-time cards, integrate alert acknowledgements.</p>
            </div>
        </div>
    </section>
    <script>
        async function refreshOpsDashboard() {
            try {
                const res = await fetch('mission-control-data.json?ts=' + Date.now());
                if (!res.ok) return;
                const data = await res.json();
                updateGauge(data);
                updateGantt(data);
            } catch (err) {
                console.error('dashboard refresh failed', err);
            }
        }

        function updateGauge(data) {
            const running = data.runningSystems?.length || 0;
            const total = data.totalTracked || running;
            const gauge = document.getElementById('automationGauge');
            const gaugeNumber = document.getElementById('gaugeNumber');
            if (gauge && gaugeNumber) {
                const value = total ? Math.min(running / total, 1) : 0;
                gauge.style.setProperty('--gauge-value', value);
                gaugeNumber.textContent = `${running} / ${total}`;
            }
            const summary = document.getElementById('automationSummary');
            if (summary) {
                summary.textContent = `${running} automation loop${running === 1 ? '' : 's'} currently running unattended.`;
            }
            const runningText = document.getElementById('runningText');
            if (runningText) runningText.textContent = (data.runningSystems || ['—']).join(' · ');
            const manualText = document.getElementById('manualText');
            if (manualText) manualText.textContent = (data.manualSystems?.length ? data.manualSystems : ['—']).join(' · ');
            const blockedText = document.getElementById('blockedText');
            if (blockedText) blockedText.textContent = (data.blockedSystems?.length ? data.blockedSystems : ['—']).join(' · ');
            const updated = document.getElementById('automationUpdated');
            if (updated && data.updatedAt) {
                updated.textContent = `Updated ${new Date(data.updatedAt).toLocaleString()}`;
            }
        }

        function updateGantt(data) {
            if (!Array.isArray(data.gantt)) return;
            data.gantt.forEach(item => {
                const row = document.querySelector(`.gantt-row[data-task-id="${item.id}"]`);
                if (!row) return;
                const nameEl = row.querySelector('.gantt-name');
                if (nameEl && item.label) nameEl.textContent = item.label;
                const etaEl = row.querySelector('.gantt-eta');
                if (etaEl && item.eta) etaEl.textContent = `ETA: ${item.eta}`;
                const progressEl = row.querySelector('.gantt-progress');
                const bar = row.querySelector('.gantt-bar');
                if (progressEl) progressEl.textContent = `${Math.round((item.progress || 0) * 100)}%`;
                if (bar) bar.style.width = `${Math.max(2, Math.min(100, (item.progress || 0) * 100))}%`;
            });
        }

        refreshOpsDashboard();
        setInterval(refreshOpsDashboard, 60000);
    </script>
</body>
</html>
